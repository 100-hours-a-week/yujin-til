## ğŸ“† 2025-10-02

### ğŸ”” ìŠ¤í¬ëŸ¼

- JPQL, SPRING Data JPA, Query DSL ê°•ì˜ ë³µìŠµ ë° ì •ë¦¬
- ì´ë²ˆì£¼ ê³¼ì œ ì§„í–‰ : ì»¤ë®¤ë‹ˆí‹° ë°±ì—”ë“œ êµ¬í˜„í•˜ê¸°
  - ì—”í‹°í‹° ì™„ë£Œ
  - íšŒì›ê°€ì… API

### ğŸš€ Today I Learned

#### JPQL(Java Persistence Query Language)

- **ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒ**ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒ, ì¡°ì‘í•  ìˆ˜ ìˆë„ë¡ ì œê³µë˜ëŠ” **ê°ì²´ì§€í–¥ ì¿¼ë¦¬ì–¸ì–´**
- ìˆœìˆ˜ JPA : ë‹¨ìˆœí•œ CRUDê°€ëŠ¥ â†’ ì¡°ê±´, ì •ë ¬, ê²€ìƒ‰ ë“±ì´ í•œë²ˆì— ì´ë¤„ì§€ì§€ì•Šê³ , ì¿¼ë¦¬ë¥¼ ì—¬ëŸ¬ë²ˆ ê°€ì ¸ì™€ì„œ JAVAì—ì„œ ê±¸ëŸ¬ì§€ëŠ” ì‘ì—… í•„ìš” â†’ ë©”ëª¨ë¦¬ ë¶€ë‹´ up
- íŠ¹ì§• : **ê°ì²´ ì§€í–¥ ì„¤ê³„ë¥¼ ìœ ì§€í•˜ë©´ì„œ, ë°ì´í„°ë² ì´ìŠ¤ì— ë…ë¦½ì ì´ê³ , ì„±ëŠ¥ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ ëª¨ë‘ í™•ë³´í•  ìˆ˜ ìˆëŠ” ê°ì²´ ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´**
  - SQLì´ ì•„ë‹Œ ì—”í‹°í‹° ì¤‘ì‹¬ ì¿¼ë¦¬ì–¸ì–´
  - JPAêµ¬í˜„ì²´ê°€ ì‚¬ìš©í•˜ëŠ” DBì— ë§ëŠ” SQLë¬¸ ì‘ì„± â‡’ ì¦‰, DBë¬¸ë²•ì— ì¢…ì†X
  - í•„ìš”í•œ ë°ì´í„°ë§Œ ì¡°íšŒí•˜ê¸°ì— ë©”ëª¨ë¦¬ ë¶€ë‹´ down, ì„±ëŠ¥ ìœ ë¦¬
- ì‚¬ìš©ë°©ë²•
  - `EntityManager.` `createQuery()`
    ```java
    List<Post> result = entityManager.createQuery(
                            "select p from User u join u.posts p where u.nickname = :nickname",
                            Post.class
                    ).setParameter("nickname", "Adapterz1")
                    .getResultList();
    ```
  - ì—”í‹°í‹° ë³„ì¹­ í•„ìˆ˜
  - í•„ë“œëª…ì€ ëŒ€ì†Œë¬¸ì êµ¬ë¶„ í•„ìˆ˜
  - JPQL í‚¤ì›Œë“œëŠ” ëŒ€ì†Œë¬¸ì êµ¬ë¶„X(SELECT = select)
  - íŒŒë¼ë¯¸í„° ë°”ì¸ë”© - ë³´í†µ ì´ë¦„ ê¸°ë°˜ ë°”ì¸ë”© ì‚¬ìš©(`:username`)
- **ê²½ë¡œ í‘œí˜„ì‹** : JPQLì—ì„œ ì—”í‹°í‹°ì˜ í•„ë“œë‚˜ ì—°ê´€ëœ ì—”í‹°í‹°ì˜ ì†ì„±ì— ì ‘ê·¼í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì (.) ì—°ì‚° ê¸°ë°˜ì˜ ì°¸ì¡° ë°©ì‹

  - ë¬µì‹œì  ì¡°ì¸

    ```sql
    select u.posts from User u

    // ì•„ë˜ì™€ ê°™ì€ í‘œí˜„ - í•­ìƒ inner joinì„
    select p.*
    from user u
    inner join post p on u.user_id = p.user_id
    ```

  - **ëª…ì‹œì  ì¡°ì¸**(ê¶Œì¥)

    ```sql
    select p.title
    from User u
    join u.posts p
    where u.username = 'kim'

    //ì•„ë˜ì™€ ê°™ìŒ - left, right join ë“± ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©ê°€ëŠ¥
    select p.title
    from user u
    inner join post p on u.user_id = p.user_id
    where u.username = 'kim'
    ```

- **N+1ê³¼ fetch join**

  - ì§€ì—° ë¡œë”©ëœ ì—°ê´€ ì—”í‹°í‹°ë¥¼ **í•œ ë²ˆì˜ ì¿¼ë¦¬ë¡œ í•¨ê»˜ ì¡°íšŒ**í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì¡°ì¸ ë°©ì‹
  - joiní•´ì„œ ì‚¬ìš©í•˜ë©´ í•„ìš”í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ë¼ë„ ë‹¤ ì¡°íšŒí•´ì˜¤ë‹ˆê¹Œ N+1ë¬¸ì œê°€ ë°œìƒí•˜ë©´ì„œ ì§€ì—°ë¡œë”© ë°œìƒí•˜ê¸°ì— ì´ë¥¼ í•´ê²°í•˜ê¸°ìœ„í•´ fetch joinì‚¬ìš©

  ```java
  select u
  from User u
  join fetch u.posts
  where u.active = true

  // ì•„ë˜ì™€ ê°™ì€ ì‹¤í–‰
  select u.*, p.*
  from user u
  inner join post p on u.user_id = p.user_id
  where u.active = true
  ```

- **Projection** : ì—”í‹°í‹° ì „ì²´ê°€ ì•„ë‹Œ í•„ìš”í•œ í•„ë“œë§Œ ì„ íƒí•´ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ëŠ” ë°ì´í„° ì¡°íšŒ ë°©ì‹

  - ì—”í‹°í‹° í”„ë¡œì ì…˜ : ì—”í‹°í‹°ì˜ ëª¨ë“  ë§¤í•‘ ì»¬ëŸ¼ ì¡°íšŒ
  - ì„ë² ë””ë“œ : SELECT ì ˆì— ì—”í‹°í‹°ì— í¬í•¨ëœ ê°’ íƒ€ì…(Embedded Type) ì„ ì§€ì •í•´, í•´ë‹¹ ê°’ íƒ€ì… ê°ì²´ë§Œ ê²°ê³¼ë¡œ ì¡°íšŒ
    ```java
    List<Profile> profiles = entityManager.createQuery(
        "select u.profile from User u", Profile.class)
        .getResultList();
    ```
  - ìŠ¤ì¹¼ë¼ : SELECT ì ˆì— ìˆ«ì, ë¬¸ìì—´, ë‚ ì§œì™€ ê°™ì€ ë‹¨ìˆœ ê°’(ìŠ¤ì¹¼ë¼ íƒ€ì…) ë§Œ ì§€ì •í•´ ì¡°íšŒ

    - objectë¡œ ë¦¬í„´ë°›ê¸° ë•Œë¬¸ì— ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê´€ë¦¬X â†’ ì½ê¸° ì „ìš© ë°ì´í„°ë‚˜ í†µê³„Â·ì§‘ê³„ ê²°ê³¼ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²½ìš°ì— ì£¼ë¡œ ì‚¬ìš©

    ```java
    List<Object[]> results = entityManager.createQuery(
        "select u.name, u.age from User u")
        .getResultList();

    for (Object[] row : results) {
        String name = (String) row[0];
        Integer age = (Integer) row[1];
        System.out.println("name = " + name + ", age = " + age);
    }
    ```

  - DTO : ìŠ¤ì¹¼ë¼ ë‹¨ì  í•´ê²°í•˜ê¸° ìœ„í•´ ë‚˜ì˜´
    ```java
    List<UserDTO> results = entityManager.createQuery(
        "select **new** com.example.dto.UserDTO(u.name, u.age) from User u", UserDTO.class)
        .getResultList();
    ```

- **Paging**
  ```java
  entityManager.createQuery("select p from Post p order by p.id", Post.class)
  		**.setFirstResult(offset)
  		.setMaxResults(limit)**
  		.getResultList();
  ```

#### Spring Data JPA

- JPA ê¸°ë°˜ì˜ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìë™í™”í•´ ì¸í„°í˜ì´ìŠ¤ë§Œìœ¼ë¡œ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” Spring ëª¨ë“ˆ

<aside>
ğŸ’¡ JPA vs Spring Data JPA

- JPA : ORMì„ ìœ„í•œ ìë°” í‘œì¤€ (ê·œê²©)
- Spring Data JPA : JPAë¥¼ ë” ì‰½ê²Œ ì“°ê²Œ í•´ì£¼ëŠ” ìŠ¤í”„ë§ì˜ ì¶”ìƒí™” ë ˆì´ì–´
</aside>

- ìˆœìˆ˜ JPA(em.persist())ëŠ” ë°˜ë³µì ì¸ ì½”ë“œ ì‚¬ìš© â†’ ì¸í„°í˜ì´ìŠ¤ë§Œìœ¼ë¡œ ë¦¬í¬ì§€í† ë¦¬ë¥¼ êµ¬í˜„í•˜ì—¬ í•œë²ˆì— ê´€ë¦¬í•  ìˆ˜ ìˆìŒ(ë‚´ë¶€ì ìœ¼ë¡  JPAì„)

```java

@Repository
public **interface** UserRepository **extends JpaRepository<User, Long>** {
}
```

- **Query method** : ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤ì˜ ë©”ì„œë“œ ì´ë¦„ì„ ê¸°ë°˜ìœ¼ë¡œ JPQL ì¿¼ë¦¬ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ì£¼ëŠ” ê¸°ëŠ¥

  - `ë©”ì„œë“œ ì´ë¦„ = ì¡°ê±´ì‹ ê·œì¹™(ì ‘ë‘ì‚¬+ì†ì„±+ì—°ê²°ì And/Or+ì •ë ¬ OrderByâ€¦)`
  - **ë©”ì„œë“œ ì´ë¦„ê³¼ í•„ë“œëª…ì˜ ë™ê¸°í™” í•„ìš”ì„±**
  - ìŠ¤í”„ë§ ê³µì‹ ë¬¸ì„œ : https://docs.spring.io/spring-data/jpa/reference/jpa/query-methods.html

  ```java
  Optional<User> findByEmail(String email);  // ì´ë©”ì¼ì´ ì¼ì¹˜í•˜ëŠ” Userë¥¼ ë‹¨ê±´ ì¡°íšŒ (Optionalë¡œ ë°˜í™˜, ì—†ìœ¼ë©´ ë¹ˆ Optional)
  // ì‹¤ì œ JPQL: select u from User u where u.email = ?1

  List<User> findByNicknameContainingIgnoreCaseOrderByCreatedAtDesc(String keyword);  // ë‹‰ë„¤ì„ì— íŠ¹ì • í‚¤ì›Œë“œê°€ í¬í•¨ëœ Userë¥¼ ì¡°íšŒ (ëŒ€ì†Œë¬¸ì ë¬´ì‹œ, ìµœì‹ ìˆœ ì •ë ¬)
  // ì‹¤ì œ JPQL: select u from User u
  //            where lower(u.nickname) like lower(concat('%', ?1, '%'))
  //            order by u.createdAt desc

  boolean existsByEmail(String email);  // íŠ¹ì • ì´ë©”ì¼ì„ ê°€ì§„ Userê°€ ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€ë§Œ í™•ì¸ (true/false ë°˜í™˜)
  // ì‹¤ì œ JPQL: select count(u) > 0 from User u where u.email = ?1

  long countByUserRole(UserRole role);  // íŠ¹ì • ê¶Œí•œ(UserRole)ì„ ê°€ì§„ User ìˆ˜ë¥¼ ë°˜í™˜
  // ì‹¤ì œ JPQL: select count(u) from User u where u.userRole = ?1
  ```

  - pageableë¡œ í˜ì´ì§•ë„ ê°€ëŠ¥

- **Auditing** : ì—”í‹°í‹°ì˜ ìƒì„± ì‹œê°„, ìˆ˜ì • ì‹œê°„, ìƒì„±ì, ìˆ˜ì •ì ê°™ì€ ë³€ê²½ ì´ë ¥ì„ ìë™ìœ¼ë¡œ ê¸°ë¡í•´ì£¼ëŠ” ê¸°ëŠ¥
  - ì—”í‹°í‹°ì— `@CreatedDate`, `@LastModifiedDate` ë“± ê´€ë ¨ ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì´ê³ , `@EnableJpaAuditing`ì„ í™œì„±í™”í•œ ë’¤ `AuditorAware`ë¥¼ êµ¬í˜„í•˜ëŠ” ì‹
- **@Query :** ë¦¬í¬ì§€í† ë¦¬ ë©”ì„œë“œì— JPQL/SQL ì¿¼ë¦¬ë¥¼ ì§ì ‘ ì‘ì„±í•´ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ì–´ë…¸
  - Query methodë¡œ í‘œí˜„í•˜ê¸° ë³µì¡í•œ ì¿¼ë¦¬ë¥¼ ëª…í™•í•˜ê²Œ ì‘ì„±í•˜ê¸° ìœ„í•¨
  ```java
  // searchPostsê°€ ìœ„ ì¿¼ë¦¬ë¥¼ ì˜ë¯¸í•œë‹¤ëŠ”ê²ƒ
  @Query("select p from Post p join p.author a " +
         "where p.title like %:keyword% and a.name = :authorName " +
         "and p.createdAt between :startDate and :endDate " +
         "and p.status = :status")
  List<Post> searchPosts(String keyword, String authorName, LocalDateTime startDate, LocalDateTime endDate, PostStatus status);
  ```
- **@EntityGraph :** íŠ¹ì • ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•  ë•Œ í•¨ê»˜ ë¡œë”©í•  ì—°ê´€ ì—”í‹°í‹°ë¥¼ ì‚¬ì „ì— ì§€ì •í•˜ì—¬, N+1 ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì–´ë…¸

  - ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ í•œ ë²ˆì— ì¡°íšŒí•˜ê¸° ìœ„í•´ **ì¡°ì¸(Join)** ì„ ìë™ìœ¼ë¡œ ì¶”ê°€í• ë•Œ ê¸°ë³¸ ì¡°ì¸ ë°©ì‹ì€ **LEFT OUTER JOIN**ì„. ì¡°ì‹¬í•´ì•¼í•¨

  ```java
  @Repository
  public interface PostRepository extends JpaRepository<Post, Long> {
  		@EntityGraph(attrivutePaths = {"author"})
  		Optional<Post> findById(Long id);
  }
  ```

    <aside>
    ğŸ’¡ JPQLì˜ fetch join vs @EntityGraph
    
     fetch joinì€ ì¿¼ë¦¬ ìì²´ë¥¼ ë°”ê¾¸ëŠ” ê²ƒì´ê³ , `@EntityGraph`ëŠ” ê¸°ì¡´ ì¿¼ë¦¬ì— ë¡œë”© ì „ëµì„ ë§ì…íˆëŠ” ì°¨ì´
    
    </aside>

- **Pageable** : í˜ì´ì§• ì²˜ë¦¬ë¥¼ ìœ„í•´ í˜ì´ì§€ ë²ˆí˜¸, í¬ê¸°, ì •ë ¬ ì •ë³´ë¥¼ ì „ë‹¬í•˜ëŠ” ê°ì²´
  - `Pageable`ì€ â€œìš”ì²­ ì •ë³´â€, `Page`Â·`Slice`Â·`List`ëŠ” â€œì‘ë‹µ í˜•íƒœâ€
  ```java
  // PageRequest.of(page, size, sort)
  Pageable pageable = PageRequest.of(0, 10, Sort.by("id").descending());
  ```
- **ì‚¬ìš©ì ì •ì˜ ë¦¬í¬ì§€í† ë¦¬ :** Spring Data JPAì—ì„œ ê¸°ë³¸ ì œê³µ ê¸°ëŠ¥ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ì—†ëŠ” ë³µì¡í•œ ì¿¼ë¦¬ë‚˜ ë¡œì§ì„ ì§ì ‘ êµ¬í˜„í•˜ê¸° ìœ„í•´ ì»¤ìŠ¤í…€ ë©”ì„œë“œë¥¼ ì¶”ê°€í•œ ë¦¬í¬ì§€í† ë¦¬

  ```java
  // ì»¤ìŠ¤í…€ ì¸í„°í˜ì´ìŠ¤ ì„ ì–¸
  public interface UserRepositoryCustom {
      List<User> searchByCustom();
  }

  // êµ¬í˜„ì²´: ë¦¬í¬ì§€í† ë¦¬ëª… + "Impl" (í•„ìˆ˜ ê·œì¹™)
  public class UserRepositoryImpl implements UserRepositoryCustom {

      @Override
      public List<User> searchByCustom() {
          ...
      }
  }

  // ìŠ¤í”„ë§ ë°ì´í„° ë¦¬í¬ì§€í† ë¦¬ì— ì»¤ìŠ¤í…€ ì¸í„°í˜ì´ìŠ¤ ì¶”ê°€ ìƒì†
  @Repository
  public interface UserRepository extends JpaRepository<User, Long>, UserRepositoryCustom {
  }
  ```

#### Query DSL

- ìë°” ì½”ë“œë¡œ JPQLì´ë‚˜ SQL ê°™ì€ ì¿¼ë¦¬ë¥¼ ì§ì ‘ ì‘ì„±í•˜ì§€ ì•Šê³ , ë©”ì„œë“œ í˜¸ì¶œê³¼ ê°ì²´ ì§€í–¥ ë¬¸ë²•ì„ ì´ìš©í•´ ì¿¼ë¦¬ë¥¼ í‘œí˜„í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬

```java
QUser.user.name.eq("test")

// JPQLë¡œ ë³´ë©´ ì•„ë˜ì™€ ê°™ìŒ
select u from User u where u.name = :name
```

- JPQL, @Query â†’ ì»´íŒŒì¼í• ë•Œ ë¬¸ìì—´ë¡œ ì¸ì‹í•´ì„œ ëŸ°íƒ€ì„ë•Œ ì˜¤ë¥˜ ë°œê²¬í•¨, ë™ì ì¿¼ë¦¬ì—ì„œ ì—¬ëŸ¬ì›€(@QueryëŠ” ë™ì  ì•„ì˜ˆë¶ˆê°€)
- ì¥ì  : íƒ€ì… ì•ˆì „í•œ ì¿¼ë¦¬ ê°€ëŠ¥, **ë™ì  ì¿¼ë¦¬ ìµœì í™”**, ë³µì¡í•œ ì¡°ê±´ì‹ í‘œí˜„ ì‰¬ì›€, ìœ ì§€ë³´ìˆ˜ ì‰¬ì›€
- **Qí´ë˜ìŠ¤**
  - QueryDSLì´ ì—”í‹°í‹°ë¥¼ ì½”ë“œë¡œ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆê²Œ í•´ ì£¼ëŠ” í•µì‹¬
  - ë¹Œë“œ ì‹œ `@Entity`(ë˜ëŠ” ì„ë² ë””ë“œ ë“±) í´ë˜ìŠ¤ë¥¼ ì½ì–´, ê° ì—”í‹°í‹°ì— 1:1ë¡œ ëŒ€ì‘í•˜ëŠ” `QUser`, `QPost` ê°™ì€ ë©”íƒ€ ëª¨ë¸ í´ë˜ìŠ¤ë¥¼ ìë™ ìƒì„±
  - Qí´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ `JPAQueryFactory`ì™€ í•¨ê»˜ Qí´ë˜ìŠ¤ë¥¼ ë¶ˆëŸ¬ì™€ ë©”ì„œë“œ ì²´ì´ë‹ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ êµ¬ì„±
    - `JPAQueryFactory` : QueryDSLì—ì„œ JPQL ì¿¼ë¦¬ë¥¼ ìë°” ì½”ë“œ í˜•íƒœë¡œ ì‘ì„±í•˜ê³  ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” í•µì‹¬ í´ë˜ìŠ¤
- **ê²€ìƒ‰ ì¡°ê±´ ì¿¼ë¦¬**

  - `BooleanBuilder`ë‚˜ `where(ì¡°ê±´1, ì¡°ê±´2 â€¦)`ì™€ ê°™ì´ ì¡°ê±´ì„ í•˜ë‚˜í•˜ë‚˜ ëª¨ë“ˆí™”í•˜ì—¬ ì‘ì„±

  ```java
  // fetch: ì—¬ëŸ¬ ê±´ ì¡°íšŒ (ì—†ìœ¼ë©´ ë¹ˆ ë¦¬ìŠ¤íŠ¸)
  List<Post> posts = queryFactory
      .selectFrom(post)
      .where(post.title.containsIgnoreCase(keyword))
      .fetch();

  // fetchOne: ë‹¨ì¼ ê±´ ì¡°íšŒ (ì—†ìœ¼ë©´ null, ì—¬ëŸ¬ ê±´ì´ë©´ ì˜ˆì™¸)
  Post one = queryFactory
      .selectFrom(post)
      .where(post.id.eq(id))
      .fetchOne();

  // fetchFirst: ì²« í–‰ë§Œ ì¡°íšŒ (limit 1)
  Post first = queryFactory
      .selectFrom(post)
      .orderBy(post.createdAt.desc())
      .fetchFirst();
  ```

- **ì •ë ¬**
  ```java
  queryFactory
      .selectFrom(user)
      .orderBy(user.nickname.desc(), user.id.asc())
      .fetch();
  ```
- **í˜ì´ì§•**

  ```java
  // ëª©ë¡ ì¡°íšŒ (í˜ì´ì§•)
  List<Entity> results = queryFactory
          .selectFrom(entity)
          .orderBy(entity.id.asc())
          .offset(offset)   // ê±´ë„ˆë›¸ í–‰ ìˆ˜
          .limit(limit)     // ê°€ì ¸ì˜¬ í–‰ ìˆ˜
          .fetch();

  // ì „ì²´ ê°œìˆ˜ ì¡°íšŒ
  Long totalCount = queryFactory
          .select(entity.count())
          .from(entity)
          .fetchOne();
  ```

- **ì¡°ì¸**

  ```java
  // í™œì„± ì‚¬ìš©ìë§Œ ì‘ì„±í•œ ê²Œì‹œê¸€ ì¡°íšŒ
  QPost p = QPost.post;
  QUser u = QUser.user;

  List<Post> posts = queryFactory
      .selectFrom(p)
      .join(p.user, u)                 // Post â†’ User ì—°ê´€ì„ ë”°ë¼ ì¡°ì¸
      .where(u.active.isTrue())        // ì‚¬ìš©ì ìƒíƒœë¡œ í•„í„°
      .fetch();
  ```

- **BooleanBuilder :** ëŸ¬ ì¡°ê±´ì„ ì¡°ë¦½í•˜ê±°ë‚˜ ë™ì ìœ¼ë¡œ ì¶”ê°€í•´ where ì ˆì„ êµ¬ì„±í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì¡°ê±´ ë¹Œë” ê°ì²´

  ```java
  // ë™ì  ì¡°ê±´ ì¡°ë¦½
  BooleanBuilder builder = new BooleanBuilder();

  if (value1 != null) {
  		builder.and(entity.field1.eq(value1));
  }

  if (start != null && end != null) {
  		builder.and(entity.field2.between(start, end));
  }

  if (keyword != null && !keyword.isBlank()) {
  		builder.or(entity.field3.containsIgnoreCase(keyword));
  }

  // ì‹¤í–‰
  List<Entity> results = queryFactory
          .selectFrom(entity)
          .where(builder)          // ë¹„ì–´ ìˆìœ¼ë©´ where ì ˆì´ ìƒëµëœ íš¨ê³¼
          .fetch();
  ```

- **where ë‹¤ì¤‘ íŒŒë¼ë¯¸í„° :** `where()` ì ˆì— ì—¬ëŸ¬ ì¡°ê±´ ë©”ì„œë“œë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•´, `null`ì¸ ì¡°ê±´ì€ ìë™ìœ¼ë¡œ ì œì™¸í•˜ëŠ” ë™ì  ì¿¼ë¦¬ ì‘ì„± ë°©ì‹

  - BooleanBuilderëŠ” í•œë²ˆì— whereì— ë„£ëŠ”ê±°ë¼ë©´, ì–˜ëŠ” ë©”ì„œë“œ í˜•íƒœë¡œ ë¶„ë¦¬í•œê²ƒ

  ```java
  // where ë‹¤ì¤‘ íŒŒë¼ë¯¸í„° ê¸°ë³¸ í˜•ì‹
  List<Post> searchPosts(String title, String content, Long minId, Long maxId) {
      return queryFactory
              .selectFrom(post)
              .where(
                      titleContains(title),
                      contentContains(content),
                      idBetween(minId, maxId)
              )
              .fetch();
  }

  // ì¡°ê±´ ë©”ì„œë“œ: ê°’ì´ ì—†ìœ¼ë©´ null ë°˜í™˜ â†’ where(...)ì—ì„œ ìë™ ë¬´ì‹œ
  private BooleanExpression titleContains(String title) {
      return (title == null || title.isBlank()) ? null : post.title.containsIgnoreCase(title);
  }

  private BooleanExpression contentContains(String content) {
      return (content == null || content.isBlank()) ? null : post.content.containsIgnoreCase(content);
  }

  private BooleanExpression idBetween(Long minId, Long maxId) {
      return (minId == null || maxId == null) ? null : post.id.between(minId, maxId);
  }
  ```

### ğŸ”¥ ì˜¤ëŠ˜ì˜ ë„ì „ ê³¼ì œì™€ í•´ê²° ë°©ë²•

- ê²Œì‹œë¬¼ ëª©ë¡ì—ì„œ â€œëŒ“ê¸€ìˆ˜/ì¢‹ì•„ìš”ìˆ˜â€ëŠ” í•„ìˆ˜ì§€ë§Œ, ê¸°ë³¸ JPA N+1 ë¬¸ì œ ë°œìƒ ì˜ˆë°© : JPQLì˜
  IN + GROUP BYë¥¼ ì‚¬ìš©í•´ ì—¬ëŸ¬ ê²Œì‹œë¬¼ì˜ ê°œìˆ˜ë¥¼ í•œ ë²ˆì— ì¡°íšŒí•˜ëŠ” ë°©ì‹ ì‚¬ìš©

### ğŸ—¨ï¸ ì˜¤ëŠ˜ì˜ íšŒê³ 

- ì–¸ì–´ê´€ë ¨ ìˆ˜ì—…ë“¤ì€ ë“£ê³  ì ìš©ì„ í•´ë´ì•¼ ì•„ëŠ”ê²ƒ ê°™ë‹¤. ì´ì œë¶€í„° ì¶”ì„ê¸°ê°„ì¸ë°, ê³„íšì„ ì˜ ì„¸ì›Œì„œ ë°±ì—”ë“œ APIêµ¬í˜„ì„ í•´ì•¼ê² ë‹¤.
