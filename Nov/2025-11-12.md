## 📆 2025-11-12

### 🔔 스크럼

- AWS(Lambda) 강의 복습 및 정리
- 9주차 과제 진행
  - 네트워크 구성

### 🚀 Today I Learned

#### Lambda

- 서버를 직접 관리하지 않고 코드만 실행할 수 있는 서버리스 컴퓨팅 서비스
  - 서버리스?
    - 진짜 서버가 없는게 아님
    - 우리가 “관리할” 컴퓨터(서버)가 없는거 → AWS가 람다서비스로 대신 해줌
- 사용자는 인프라 신경쓰지 않고, 특정 이벤트 발생 시 자동으로 실행될 코드를 작성하고 배포할 수 있음
- 동작 방식
  1. 어떤 이벤트 발생
  2. 람다 함수가 그 이벤트를 트리거로 실행
     1. 컨테이너 띄우고
     2. 동작하고 리턴하고
     3. 5~15분 내 사라짐
- 그럼 모든 코드를 다 올려둘 수 있나?
  - 런타임 = 실행환경을 지원함
    - ex) java → JVM → JRE
  - 자바, 파이썬, 노드, php 등
- 장점
  - 비용 효율적 ← 실제로 사용한 컴퓨팅 자원에 대해서만 비용을 지불
  - 인프라 운영에 신경안써도됨 ← 람다 + 관리형 서비스의 특징임
  - 배포도 쉽다
    - 배포의 어려움을 만드는건 = 환경 변수
    - 이걸 람다가 해주니까 코드만 정상적으로 돌아가면, 배포가 됨
  - 비즈니스 로직에 집중할 수 있음
  - 요청마다 컴퓨터 할당함 → 수평적 확장이 쉬움
    - 최대 1000개의 동시 요청이와도 컨테이너가 생성됨
- 단점
  - 서버를 켜야함 = 반응이 느림
    - ColdStart : 함수가 처음 호출될때 람다함수를 실행시키기 위한 부수적인 설정때문에 발생하는 딜레이
    - 방지하는 방법
      - 컴퓨터를 안끄면 됨 = 비싸짐
      - 5~15분 사이에 새로운 요청이 없으면 꺼지니까 그마다 한번씩 요청보냄 → 돈나감
  - 기억을 못함 → stateless함
    - 컴퓨터가 켜졌다가 꺼지니까
    - 그래서 EFS에 파일 넣어놓고 마운트 시킬 수 있음
  - 하드웨어 제한이 빡빡하다
    - 컴퓨터가 계속 켜졌다 꺼졌다하니까
    - 너무 무거운 애들은 실행할 수 없음
  - 동시성의 제한
    - 1,000개까지만 가능 → 1,001개 부터 429 에러 내뱉음
    - 람다는 리전별로 관리됨
      - 함수당 1,000개 아니라, 전체 1000개임
    - 해결방법
      - 함수별로 요청 몇개받을지 예약할 수 있음
      - 1,000 → AWS한테 늘려달라고 요청할 수 있음
  - 요청 시간에 제한있음
    - 컨테이너는 요청1개당 최대 15분간만 사용할 수 있음
- 대표적인 사용처
  - 이미지 업로드 서버 대체 가능
    - 일반적은 API 요청 ← 1개 요청당 자원 10KM
    - 이미지 업로드 요청 ← 1개 요청당 자원 100MB
      - 이미지 업로드 서버 = 자원을 많이 들고 있어여함
      - 트래픽 갑자기 몰리면 뻗음
    - 그래서 보통 이미지업로드 서버 분리함 → 람다로 해서 이미지 업로드 기능만 서버리스
  - 이미지 변환 기능
    - S3업로드 이벤트
      - ex) 특정 버킷에 새로운 이미지 업로드되면 이벤트로 발생
      - S3업로드 이벤트 받으면, 그 객체를 압축하는 작업
  - 배치 작업
    - 특정 시기마다 한 번에 처리해야하는 작업
    - 고아 이미지 ← S3업로드 되어있는데, 그 누구도 안쓰는이미지. 라이프사이클로도 처리할 수 있는데, 넓은 범위라 바로바로 지우고싶을때 람다로 배치작업 시킬 수 있음
    - 일간 통계 만들기
  - 서버 용량 감지
    - CloudWatch ← 로그, 인스턴스 CPU, RAM 자원량 확인할 수 이음
      - 자원이 부족하면 이벤트 발생시킴(error msg보낸다거나)
  - 슬로우 쿼리 감지
    - RDS ← 쿼리 중에서 너무 느리게 처리되는 쿼리를 파일에다가 적고
    - 이벤트 발생시키면, 람다가 슬랙이나 관리자한테 알려줌

### 🔥 오늘의 도전 과제와 해결 방법

- Lambda 실습진행시 502에러 발생 : 로그를 확인해보니 압축문제였다.
  Lambda는 zip을 풀어서 최상단(루트) 에서 지정된 handler 파일(index.js)을 찾는데, 폴더가 한번 더 감싸져있어서 index.js를 찾지 못해 502에러가 발생했다. 압축을 다시하여 실행하니 잘 동작했다.
- WAS와 RDS를 같은 서브넷에 두어야할까? 다른 서브넷에 두어야할까? : 보안 그룹을 잘 사용하면 별도의 서브넷을 사용하지 않고도 추가적인 보안 계층을 구성할 수 있고, 다른 프라이빗을 나누어 초기배포를 복잡하게 만드는거보다는 하나에 넣는게 낫다고 판단해서 같은 서브넷에 할당하기로 결정했다.

### 🗨️ 오늘의 회고

- VPC 구성부터, 서브넷, 인스턴스 등 처음부터 설계하는것이 정말 막막하다. 일단 어느정도 구성해서 해보고있긴 한데, 맞게 하고있는건지 잘 모르겠다.
