## 📆 2025-12-08

### 🔔 스크럼

- 테스트 강의 복습 및 정리

### 🚀 Today I Learned

#### 테스트

- 소프트웨어가 의도한 대로 동작하는지 검증하고, 결함을 미리 발견하는 과정
- 종류
  - 기능의 검증
    - E2E 테스트 : 사용자 관점에서 처음부터 끝까지
    - 통합 테스트 : 모듈간의 상호 작용 검증(API ↔ DB 등)
    - 단위 테스트 : 가장 작은 단위 (함수) 검증
  - 성능의 검증 : 내 시스템은 얼만큼의 트래픽을 견딜 수 있는가?
- 언제 무엇을 해야하나?
  1. 기능에 대한 검증
     - Unit, 통합, E2E등, 기능우선
  2. 성능에 대한 검증
     - 기능이 동작해야, 트래픽 테스트
     - LMS,Saas, 어드민 서비스 등 일부는 부하세트스 안할 수도 있음(자신의 팀이 하는 서비스가 트래픽에 안맞는경우)
  3. CI/CD 에서의 도입
     - 배포 과정중, 테스트 자동화

#### 대규모 트래픽

- 부하테스트의 종류
  - (Average) Load Test : 목표 값에 해당하는 부하를 견딜 수 있는지
    - 가장 일반적인 형태의 테스트
    - 평소 트래픽 안정적 처리 확인
    - 성능 기준 충족 여부 확인
    - CI/CD 부하테스트시 사용
    - 실무 : 기능 배포 전 기본 검증
    - 개선 : 로직 오류, 디비 인덱스 누락 확인
  - **Stress Test** : 시스템의 안정성을 확인하는 테스트
    - 시스템의 최대치에 해당하는 부하 전달
    - 시스템 리소스를 끝까지 사용하는 상황
    - 서버가 느려지더라도, 죽지 않고 버티는지
    - 시스템의 “안정성” 확인 목적
    - 실무 : 대규모 이벤트 전, 오토스케일링 확인
    - 개선 : ASG,HPV 등 설정 튜닝 / 타임아웃,에러 처리 등
  - **Spike Test** : 급격한 트래픽 변화에 시스템 체크
    - 아주 짧은 시간에 부하 수직 상승 → 다시 수직 하락
    - 급격한 트래픽 변화에 시스템 변화 체크
    - 실무 : 푸시알람, 쿠폰 등 / 이벤트 전후 시스템 체크
    - 개선 : 콜드 스타트, DB 커넥션 풀, 캐시 등 / 급격한 변화에 반응해야하는 리소스 체크
  - **Breakpoint Test** : 시스템의 한계점을 찾는 테스트
    - 서버가 에러를 뱉을 때까지 부하 늘리기
    - 시스템의 최대 용량 파악
    - 그래프가 우상향하다가 끊기는 지점 찾기
    - 실무 : 서퍼 스펙 산정할때 / 아키텍쳐 도입 후 한계 성능 측정 / 병목 구간 찾기
    - 개선 : 시스템 약점 찾기
  - Soak Test : 장시간 실행 시 에러 찾기
    - 적당한 부하를 장시간(24시간, 1주일 등) 돌려야 보이는 문제 찾기
    - 메모리 누수, 커넥션 풀 관리, 소켓 초기화 등
    - 실무 : 메인 서비스 오픈 전 리허설
    - 개선 : 메모리 누수, 디스크 용량, DB연결 등 / 장시간 작동 시 발생하는 이슈 체크

#### 부하테스트

- 용어
  - 처리량(Throughput)
    - 부하 테스트에서 서비스가 1초당 처리할 수 있는 트래픽양 = TPS
    - 초당 몇개의 요청을 처리하는가?
    - 높아야 좋은것
    - 시스템전체의 TPS = 병목지점에서의 TPS ex) DB
    - 특정 병목 지점을 해소하면, 다른 곳에 새로운 병목 지점이 발생함
    - 보통 처리량이 낮으니까 지연시간이 길어지는것
  - 지연시간(Latency)
    - 사용자가 요청을 보낸 순간부터, 응답을 받는순간까지 걸리는 시간
    - 평균 응답보다 p95,p99가 중요
      - 95%,99%의 사람들이 늦게받으니까 평균응답시간이 길어지는것
    - 전체 시스템의 응답시간을 합친 값 → 어떤 부분을 개선하더라도 지연시간이 개선됨
- 실무에서 부하테스트 구성할때
  - 문화 만들기 → 팀끼리 해야함. 왜 해야하는지를 합리적으로 찾아야함
  - **부하 테스트 목표 설정**
    - 핵심
      - 처리량
        - 목표 TPS : 예상 접속자수, 요청 수 계산해서 산정
      - 응답속도
        - 서비스/기능마다 다르다
    - 목표를 설정하고, 어디서 문제가 나는지 체크
  - 부하테스트 구성
    - 실무에서의 상황을 고려해야함
    1. 공격자 : K6,ngrinder 등 트래픽을 만들어서 넣는 툴
    2. 수비자 : WAS,DB,Cache
       - DB, 캐시 사이즈 중요
    3. 심판관 : 모니터링 툴 ex) 프로메테우스,그라파나 등
       - 네이버 클라우드 PINPOINT는 어디서 어디 로드 걸렸는지 시각화잘되어있음
       - 실무에서는 예거 많이씀
    - 위의 셋이 분리되어있어야함

### 🗨️ 오늘의 회고

- 이번 주 수요일부터 부하테스트를 진행하게 돼서, 오늘 배운 내용들이 전체 흐름을 이해하는 데 꽤 도움이 됐다. 그동안 “부하테스트 = 단순히 트래픽 많이 넣는 것” 정도로만 알고 있었는데,
  각 테스트가 어떤 목적을 갖고 있고 실제 서비스에서 어떤 문제를 잡아내는지를 배울 수 있어서 좋았다. 실제 테스트를 돌려보면서 이 이론들이 어떻게 연결될지 궁금해진다.
