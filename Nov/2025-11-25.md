## 📆 2025-11-25

### 🔔 스크럼

- 무중단 배포 전략 강의 복습 및 정리
- 이번 주차 과제 구상 : CI/CD 과정을 FE, BE 프로젝트에 GitHub Actions를 사용해 적용

### 🚀 Today I Learned

#### Zero-downtime Deployment(무중단 배포)

- 서비스를 새로운 버전으로 배포할때, 중단이 없이 배포하는걸 의미
- 중단이 있는 배포방식
  - 정기/임시/긴급 점검 등
  - 주로 게임
- 중단이 없는 배포방식
  - 크롬 업데이트
  - 엡 서비스
  - 네이버, SNS 등
- 목표
  - 사용자가 서비스를 사용하고 있음 → 그 와중에 다운타임을 못느끼게
  - **즉, 사용자의 가용성 높이기 위해**
- 왜 필요할까?
  - 고가용성
    - 사용자가 못견딤 = 중단을 못견딤
      - 중단 시, 비즈니스에 심각한 문제가 생길 때 사용함
  - 배포 위험 최소
    - 배포는 새로운 기능, 혹은 버그를 수정하고 이걸 반영하는 것
    - 여러 단계 테스트 거침
      - 거쳐도, 어차피 사람이 함. 테스트코드도 사람이 함 → 실수할 수 있음
    - 배포는 롤백 어려움 → 어떤 문제가 생길지 모른다
    - 크리티컬 이슈가 생기면, 바로 배포 롤백하기
    - 서비스 안정성
  - 민첩함
    - 배포가 빠르고 자주 이뤄질 수 있다.
- 핵심원리
  - 구성
    1. 로드밸런서
    2. 2대 이상의 인스턴스
  - 순서
    1. 로드밸런서, 현재 운영중인 구버전 서버로 트래픽 보내고있음
    2. 신 서버, 별도로 만들어짐 (인스턴스)
    3. 신 서버가 안정되면, 로드밸런서에서 트래픽을 신서버로 옮김
    4. 구버전을 종료한다. 계속 실행
  - 이 순서를 어떻게 가져가냐, 어떻게 트래픽 배분할거냐에 따라 무중단 배포 전략이 3가지가 나옴
    - 블루/그린 배포
    - 롤링 배포
    - 카나리 배포

#### Blue/Green Deployment

- 2개의 독립된 환경(블루,그린)을 운영하며, 트래픽을 새로운 버전으로 전환해 서비스 중단 없이 배포와 롤백이 가능한 배포 방식
- 준비 완료되면 한방에 블루→ 그린으로 트래픽 전환됨
- 장점
  - 롤백이 엄청 빠르다
  - 호환성 문제가 없음
    - 다른 방식들은 v1,v2가 일정 시기동안 동시에 실행되고 있음
    - ex) 앱에서 JSON으로 뭔가를 받고있는데, v1,v2에 들어오는 값이 다르면 호환성 문제가 있다는것
- 단점(고려사항)
  - 리소스를 일시적으로 2배를 요구함
    - 2개의 환경이 완벽히 분리된다→ 2개의 환경이 준비되어여함 & 테스트
- 구성요소
  - Blue 환경 : 초기에만 현재 서비스 중인 운영환경, 사용자가 실제로 접근하고 있는 버전
  - Green 환경 : 버전이 배포되는 대기 중인 환경, 전환 준비가 완료되면 서비스 대상이 됨
  - 트래픽 전환 도구 : 블루에서 그린으로 사용자의 요청을 즉시 전환할 수 있도록 설정을 변경하는 구성요소
    - NginX로 직접 구현가능, ALB에서 설정으로 구현 가능
  - 헬스 체크 및 모니터링 : Green 환경이 정상적으로 동작하는지 사전 검증하는 절차
  - 롤백 매커니즘 : Green 전환 이후 문제 발생시, 빠르게 Blue로 복귀할 수 있도록 설계된 자동/수동 복원 절차
- 사용 이유 : 2개의 완전 분리된 환경에서 새 버전을 검증한 뒤 트래픽 스위치만으로(블루갈지, 그린갈지) 즉시 롤아웃/롤백할 수 있어 무중단 배포 과정을 단순화하여 배포할 수 있기 때문
- 중요도가 높을때 사용 → 금융, 이커머스

#### Rolling Deployment

- 기존 인스턴스를 하나씩 새로운 버전으로 순차 교체하며 전체 서비스를 점진적으로 업데이트하는 배포 방식
- v1 인스턴스 3개
  - v2 인스턴스 1개 키고
  - v1 1개 끄고
- 배포 과정에서 항상 일정 수 이상의 인스턴스 돌아가고있음
- 인스턴스가 각각 독립적일때 많이 사용함
  - 인스턴스 1개에 다른 요소들이 없을때
  - 백엔드 서비스 ← 다른 서비스랑 합쳐져서 인스턴스 구성되어 있을때는 잘 사용안함
- 다중 인스턴스 구조를 전제로 함
  - Kubernetes, AWS ECS, Google Cloud Run 등 대부분의 오케스트레이션 및 클라우드 플랫폼에서 기본 배포 전략임
- 사용이유 : 서버를 일정 단위로 순차 교체해 전체 서비스를 중단 없이 새 버전을 점진 배포하고, 문제가 생겨도 영향을 받은 인스턴스만 교체해 영향을 최소화할 수 있기 때문에 사용함
- 장점
  - 블루/그린에 비해 리소스를 효율적으로 사용함
- 단점
  - 구현이 어렵고 복잡함 ← 그래서 보통 직접구현보다는 서비스에서 제공해주는거 사용함
  - 호환성 문제 발생함
  - 배포 속도가 느림
- 작은규모에서 주로 사용함

#### Canary Deployment

- 새 버전을 전체에 적용하기 전에 일부만 트래픽만 보내보는것.
- 보통 5%정도부터 시작. 100%될때까지
- 사용이유 : 새 버전의 안정성을 실사용 환경에서 미리 검증하여 전체 배포로 인한 장애를 사전에 방지하기 위함
- 장점
  - 위험 최소화 가능
    - 실제 사용자가 쓰고, 어떤 문제가 s있는지, 발생하는지 미리 보고 대응할 수 있음
    - 문제 발생에 대한 여파가 크지 않음.
  - 사용자가 배포과정에서 이슈를 겪는 비율이 상당히 낮아짐
- 단점
  - 트래픽 분배 ← 비용, 복잡하다
  - 배포 속도가 느림
  - 호환성 문제 발생함
- 대규모 서비스, 신기술 도입, 사용자 사용성이 너무 중요할때 주로 사용함

### 🗨️ 오늘의 회고

- 실습을 따라해보면서 대충 감은 잡았는데, 이제 실제로 해봐야 알 것 같다. 저번 주차 과제인 docker환경에다가 적용해보고, 빨리 끝나면 다른 환경으로 구성해서 연결해보고싶다.
