## 📆 2025-11-26

### 🔔 스크럼

- 이번 주차 과제 진행
  - Backend / Frontend 각각 GitHub Actions CI/CD workflow 작성
  - EC2에 Docker 기반 자동 배포 파이프라인 구성
  - docker-compose / nginx.conf 자동 업데이트 구조 구축

### 🚀 Today I Learned

- 기존 Dockerfile 내부에서 ./gradlew build를 수행하던 방식은
  컨테이너 빌드마다 전체 Gradle 빌드를 다시 해야 해서 비효율적 →
  CI/CD 파이프라인에서 jar를 먼저 빌드 후 Dockerfile에는 jar COPY만 하는 구조로 변경 : Docker build 속도 향상, 이미지 구조 단순화, CI 단계에서 실패/성공이 명확히 분리된다는 장점이 있음

- Gradle Caching 사용 시, 불필요한 중복 의존성 다운로드를 방지해 빌드 속도가 크게 빨라진다는 것을 경험함

- Nginx에서 SSL 인증서를 마운트할 때 /etc/letsencrypt 전체를 마운트하는 대신 실제 필요한 /etc/letsencrypt/live/<도메인> 경로만 마운트하는 것이 더 안전하고 효율적인 구조임

### 🔥 오늘의 도전 과제와 해결 방법

- Test with Gradle 실패
  - ./gradlew test -i 로 오류 코드를 살펴보니, 직접 작성했던 코드의 오류가 아닌, 기본으로 만들어주는 테스트함수 오류로 해당 함수 삭제하여 해결
- SCP로 docker-compose.yml, nginx.conf 복사 실패
  - deploy/ 상위 디렉토리가 tar에 포함되어 EC2에서 동일한 폴더를 만들려다 권한 오류 발생 → strip_components: 1 로 tar 압축 시 상위 폴더 제거 → 파일만 전송되도록 수정 & sudo chown -R ubuntu:ubuntu /home/ubuntu/community 로 community 폴더 전체 권한 재정비
- Deploy to EC2 단계에서 권한 오류
  - GitHub Actions SSH 계정이 Docker 데몬 접근 권한 없음 → 모든 docker 명령에 sudo 추가하여 배포 스크립트 정상 실행

### 🗨️ 오늘의 회고

- CI/CD를 구현하면서 단순히 “yaml 하나 추가하면 끝”일 줄 알았지만, 실제로는 파일 경로, tar 구조, 권한, Docker 그룹, job 분리, 이미지 전략 등 운영 환경에서 고려해야 하는 다양한 요소가 있다는 것을 배웠다.
- 문제들이 많이 터졌지만 하나씩 해결하면서 CI/CD가 왜 필수 기술인지, 그리고 왜 많은 팀들이 Docker + GitHub Actions를 쓰는지를 알게된 하루였다.
