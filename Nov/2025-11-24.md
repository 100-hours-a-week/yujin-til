## 📆 2025-11-24

### 🔔 스크럼

- CI/CD 강의 복습 및 정리
  - 실습하기

### 🚀 Today I Learned

#### CI(**Continuous Integration**)

- 개발자들이 작성한 코드를 자동으로 통합/테스트하여 코드의 품질을 지속적으로 유지하는 개발 프로세스
- 왜 등장했나
  - 과거 : 개발자들의 코드 배포/통합 주기가 길었음
  - 요즘 : 특정 기능에 대한 추가개발/업그레이드 등 코드 반영 주기 빠름
- 꼭 돌아가야하는 코드는 테스트코드를 짜놓음.
- 단계
  - 개발 : 코드 작업 수행
  - 소스관리 : Git/GitHub같은 툴로 변경사항 관리
  - 빌드 : 통합된 소스 코드를 컴파일하여 실행 가능한 형태로 변환하는 단계
    - ex) Jenkins, Github Actions ..
  - 테스트 : 빌드된 코드가 정상작동하는지 자동화된 테스트 수행하는 단계
    - ex) JUnit, Jest, Selenium ..
  - 리포트 : 품질 상태를 공유하는 단계
    - ex) Jenkins, Github Actions, Slack ..
- 사용이유 : 코드 통합 과정에서 발생하는 문제를 빠르게 찾고 빌드 및 테스트를 자동화하기 위해
- Jenkins vs Github Actions
  - 둘다 CI tools(service)
  - Jenkins는 CI/CD tools(도구)임.
    - 장점
      - 직접 커스터마이징 많이 필요
        - = 자유도 높다 ← 서비스 환경이 복잡하면, Jenkins 써야함
      - 온프레미스 환경
        - 셀프 호스팅, 셀프 설치, 플러그인 직접 관리해야함
        - 플러그인 엄청 많음. 확장 거의 자유
        - 배포,빌드,테스트,알림, 실패 케이스 자동화 가능
      - 완전히 제어 가능
      - 대규모 프로젝트에서 사용
        - 상당히 많은 작업을 해야한다
        - 특정 보안 작업 ← 우리 내부 서버에 privat subnet instance
        - 커스텀 환경
    - 단점
      - 관리 포인트 늘어남
      - 젠킨스 자원도 부족하면?
      - os 업데이트, 패키지 업데이트, 다 각자 대응 해야함
  - Github Actions는 CI/CD Service임
    - 우리가 인프라 만들 필요가 없다
    - 장점
      - 깃헙저장소랑 통합
      - 서버 관리 안함
      - 빠르게 CI/CD 할 수 있음
      - 퍼블릭 레포는 무료, 프라이빗은 CICD 돌아가는 시간에 따라 과금이 생김
    - 단점
      - 자유도가 낮다
      - 비용 발생
        - 대규모 프로젝트(CI/CD가 많이 돌아가는 환경) 같은 경우는 돈 많이 나감
      - 실행 시간 제한, 스토리지 제한 있음
    - 스타트업, 프로젝트 단위, 오픈소스(퍼블릭)일때 많이 사용
- 테스트 자동화 종류
  - 유닛 테스트
    - 특정 함수에 대한 테스트
  - 통합 테스트
    - API ← 회원 가입 기능 API에 대한 테스트
    - 개발자들은 보통 여기까지는 작성하는 경우 많음
  - **E2E 테스트**
    - 실제 사용자 시나리오를 모방하여 애플리케이션의 전체적인 기능 검증
    - ex) 웹페이지
      - Selenium ← 웹 브라우저를 코드로 실행함. 주로 웹 크롤링할때 사용함
    - 해당 테스트는 보통 외부에서 많이 실행함

#### CD(Coutinuous Deployment)

- 코드가 CI를 통과하면 운영환경까지 자동으로 배포되는 소프트웨어 배포 프로세스
- CI가 코드의 통합 및 품질 검증을 완료하면 CD가 이를 이어받아 운영환경으로 배포까지 자동처리
- 단계
  1. 배포 → 초기에는 여기까지 많이 사용함
  2. 모니터링 및 리포트
- 사용이유 : 자동 빌드와 테스트로 품질이 검증된 새로운 기능과 수정 사항을 빠르게 배포하기 위해서
- Coutinuous Deployment vs Delivery
  - 자동화 단계의 범위를 달리하는 같은 파이프라인 전략
  - Deployment : 매우 빈번한 배포를 할때, 자동화된 테스트 및 모니터링이 필수임
    - CI까지 밖에 제어가 안됨. ok나면 바로 배포됨.
    - 작은기업에서 많이 사용. 빠른 배포와 피드백이 목적이니까
    - GitHub Actions는 이걸 지원함
  - Delivery : 배포는 수동 승인 후 진행됰
    - 중견기업, 금융권에서 많이 사용.

#### Github Actions

- Github 내에서 코드 빌드, 테스트, 배포 등의 워크플로우를 자동화하는 CI/CD 도구
- 구성요소
  - Event
    - 워크플로우를 실행하는 트리거 또는 조건
    - ex) push, pr, pr_review, fork, discussion, issues 등
    - https://docs.github.com/ko/actions/reference/workflows-and-actions/events-that-trigger-workflows
  - Workflow
    - 실행할 작업과 순서를 정의한 .yml파일
    - .github/workflows에 저장됨
  - Job
    - 워크플로우 내에서 독립적으로 실행되는 작업 단위
    - 여러 작업은 병렬로 실행할 수도 있고, 순차적으로 실행할 수도 있음
    - 1개 이상의 Step 포함함
    - ex) build, deploy
  - Step
    - Job 내에서 순차적으로 수행되는 개별 명령이나 작업
    - ex) npm install, npm test
  - Action
    - 워크플로우 내에서 특정 기능을 재사용 가능하도록 미리 정의된 코드조각
    - 공식 또는 커뮤니티에서 제공함
    - ex) actions/checkout, actions/setup-node
  - Runner
    - 워크플로우가 실제로 실행되는 환경
    - ex) Ubuntu, macOS
- 사용 이유 : 코드 변경시 빌드, 테스트, 배포를 GitHub 내에서 자동화하여 개발 생산성과 코드 품질을 높이기 위해

#### Jenkins

- 소프트웨어 개발 프로세스의 빌드, 테스트, 배포 작업을 자동화하는 오프소스 CI/CD 도구
- 사용이유 : 맞춤형 파이프라인 구성 가능(Github action은 제공해주는것만 사용할 수 있음)
- Jenkins Pipeline
  - Freestyle 프로젝트
    - 기본으로 제공하는 가장 단순한 작업 구성 방식
    - 각단계를 GUI를 통해 수동으로 설정함
    - 버전관리가 어렵고, 사용이 제한적임
  - pipeline 프로젝트(실무에서는 이거 많이 사용)
    - **Jenkinsfile**이라는 파일에 파이프라인을 명시적으로 정의하여 Git과 함께 버전 관리
    - 유연성, 재사용성이 높다.

#### ECR(Elastic Container Registry)

- AWS에서 제공하는 컨테이너 이미지 저장소 서비스 = Docker hub랑 같은 역할
- 완전 관리형 서비스 ← 과금 상품(보관된 이미지의 크기 만큼)
  - Life cycle 설정 가능
- private에서 이미지 접근을 위해 NAT gateway보다는 ECR을 사용하면됨
- 사용이유 : AWS 서비스와의 원활한 통합
  - AWS Fargate
    - 서버를 직접 관리할 필요없이 컨테이너를 실행할 수 있는 서버리스 컴퓨팅 엔진
    - AWS ECS(작은규모), EKS(큰 큐모)와 함께 사용되며 인프라 프로비저닝, 확장, 패치 등을 자동으로 처리함

### 🔥 오늘의 도전 과제와 해결 방법

- GitHub Actions로 EC2에 CI/CD를 구성하던 중, ssh-keyscan 단계에서
  아무런 에러 메시지 없이 exit code 1 이 계속 발생함
  - 처음에는 SSH 키 포맷 문제라고 생각해 PEM 키를 재복사하고, GitHub Secrets 포맷까지 모두 점검했지만 여전히 동일한 에러가 발생해 원인을 찾는 데 어려움이 있었음
  - → 결국 문제는 SSH 키가 아니라 GitHub Actions Runner가 EC2로 접근할 수 없는 환경 문제. EC2의 22번 포트가 내 IP만 허용되게끔 보안그룹이 설정되어있어 IP가 매번 바뀌는 GitHub Actions Runner는 EC2에 접근 자체를 못 해서 실패한 것.

### 🗨️ 오늘의 회고

- 항상 개념은 어렵지 않은데, 실제로 적용해보는게 어려운 것 같다. 클라우드는 직접 많이 다뤄봐야 감이 오는 것 같다. 이번주차 과제도 화이팅 해보자!
